# minimal-ocr-build.yml
name: Minimal OCR Face Build

on: [push, workflow_dispatch]

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - uses: actions/setup-python@v5
      with:
        python-version: "3.10"
        cache: 'pip'
    
    - name: Install Essentials
      run: |
        choco install cmake -y
        pip install --upgrade pip setuptools wheel
        
        # Minimal dependencies
        pip install opencv-python numpy pandas pillow
        pip install face-recognition dlib
        pip install pytesseract easyocr
        pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu
        pip install pyqt5 pyinstaller
    
    - name: Build EXE
      shell: cmd
      run: |
        pyinstaller ^
         --onefile ^
         --noconsole ^
         --name OCRApp ^
         --add-data "cameras.csv;." ^
         --hidden-import pkg_resources ^
         --hidden-import cv2 ^
         --hidden-import torch ^
         --clean ^
         Main.py
    
    - uses: actions/upload-artifact@v4
      with:
        name: OCR-App
        path: dist/OCRApp.exe
